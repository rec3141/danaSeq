// ============================================================================
// Digital Research Alliance of Canada (formerly Compute Canada) - Nextflow Config
// ============================================================================
//
// Generic SLURM configuration for Alliance HPC clusters (Cedar, Narval, Fir, etc.)
// Copy this file and customize for your site:
//
//   cp computecanada.config fir.config   # edit account, paths, partitions
//
// Then run the pipeline with:
//   ./run-mag.sh --input /path/to/reads --outdir /path/to/output -c fir.config
//
// ============================================================================

process {
    executor       = 'slurm'
    clusterOptions = '--account=def-YOURPI'

    // Alliance SLURM jobs don't source ~/.bashrc â€” conda/mamba must be
    // explicitly loaded so Nextflow can activate per-process conda envs.
    // Update the path below to your Miniforge/Miniconda installation.
    beforeScript   = 'source ~/scratch/miniforge3/etc/profile.d/conda.sh && source ~/scratch/miniforge3/etc/profile.d/mamba.sh'
}

executor {
    name            = 'slurm'
    queueSize       = 20          // max concurrent SLURM jobs (be a good neighbour)
    submitRateLimit = '10/1min'   // avoid flooding the scheduler
    pollInterval    = '30 sec'    // how often to check job status
}
